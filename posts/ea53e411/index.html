<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="/images/icons/favicon-16x16.ico?v=2.0.0-rc.0" type="image/png" sizes="16x16"><link rel="icon" href="/images/icons/favicon-32x32.ico?v=2.0.0-rc.0" type="image/png" sizes="32x32"><meta name="description" content="0x00 ETH的前世今生       比特币开创了去中心化加密货币的先河，自诞生起，五年多的时间充分检验了区块链技术的可行性和安全性。比特币的区块链事实上是一套分布式的数据库，在其中加进一个符号比特币，并规定一套协议使得这个符号可以在数据库上安全地转移，并且无需信任第三方，这些特征的组合完美地构造了一个货币传输体系“比特币网络”。然而比特币并不完美，其中协议的扩展性是一项不"><meta property="og:type" content="article"><meta property="og:title" content="区块链：初探ETH私链搭建"><meta property="og:url" content="https://www.gov-cn.cn/posts/ea53e411/index.html"><meta property="og:site_name" content="hihi007&#39;s Blog"><meta property="og:description" content="0x00 ETH的前世今生       比特币开创了去中心化加密货币的先河，自诞生起，五年多的时间充分检验了区块链技术的可行性和安全性。比特币的区块链事实上是一套分布式的数据库，在其中加进一个符号比特币，并规定一套协议使得这个符号可以在数据库上安全地转移，并且无需信任第三方，这些特征的组合完美地构造了一个货币传输体系“比特币网络”。然而比特币并不完美，其中协议的扩展性是一项不"><meta property="article:published_time" content="2020-05-27T13:14:27.000Z"><meta property="article:modified_time" content="2020-05-27T13:17:50.404Z"><meta property="article:author" content="hihi007"><meta property="article:tag" content="区块链"><meta property="article:tag" content="ETH"><meta name="twitter:card" content="summary"><meta name="keywords" content="hihi007, hihi007's Blog"><meta name="description" content="hihi007的个人博客"><title>区块链：初探ETH私链搭建</title><link ref="canonical" href="https://www.gov-cn.cn/posts/ea53e411/"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css" type="text/css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" type="text/css"><link rel="stylesheet" href="/css/index.css?v=2.0.0-rc.0"><script>var Stun=window.Stun||{},CONFIG={root:"/",algolia:void 0,fontIcon:{prompt:{success:"fas fa-check-circle",info:"fas fa-arrow-circle-right",warning:"fas fa-exclamation-circle",error:"fas fa-times-circle"},copyBtn:"fas fa-copy"},sidebar:{offsetTop:"20px",tocMaxDepth:6},header:{enable:!0,showOnPost:!0,scrollDownIcon:!0},postWidget:{endText:!0},nightMode:{enable:!0},back2top:{enable:!0},codeblock:{style:"carbon",highlight:"ocean",wordWrap:!0},reward:!0,fancybox:!0,zoomImage:{gapAside:"20px"},galleryWaterfall:void 0,lazyload:!1,pjax:{avoidBanner:!1},externalLink:{icon:{enable:!0,name:"fas fa-external-link-alt"}},shortcuts:void 0,prompt:{copyButton:"Copy",copySuccess:"Copy Success",copyError:"Copy Error"},sourcePath:{js:"js",css:"css",images:"images"}};window.CONFIG=CONFIG</script><meta name="generator" content="Hexo 4.2.0"></head><body><div class="container" id="container"><header class="header" id="header"><div class="header-inner"><nav class="header-nav header-nav--fixed"><div class="header-nav-inner"><div class="header-nav-menubtn"><i class="fas fa-bars"></i></div><div class="header-nav-menu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/"><span class="header-nav-menu-item__icon"><i class="fas fa-home"></i></span><span class="header-nav-menu-item__text">Home</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="javascript:;" onclick="return!1"><span class="header-nav-menu-item__icon"><i class="fas fa-list"></i></span><span class="header-nav-menu-item__text">文章</span></a><div class="header-nav-submenu"><div class="header-nav-submenu-item"><a class="header-nav-submenu-item__link" href="/archives/"><span class="header-nav-submenu-item__icon"><i class="fas fa-folder-open"></i></span><span class="header-nav-submenu-item__text">Archives</span></a></div><div class="header-nav-submenu-item"><a class="header-nav-submenu-item__link" href="/categories/"><span class="header-nav-submenu-item__icon"><i class="fas fa-layer-group"></i></span><span class="header-nav-submenu-item__text">Categories</span></a></div><div class="header-nav-submenu-item"><a class="header-nav-submenu-item__link" href="/tags/"><span class="header-nav-submenu-item__icon"><i class="fas fa-tags"></i></span><span class="header-nav-submenu-item__text">Tags</span></a></div></div></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="javascript:;" onclick="return!1"><span class="header-nav-menu-item__icon"><i class="fas fa-flask"></i></span><span class="header-nav-menu-item__text">实验室</span></a><div class="header-nav-submenu"><div class="header-nav-submenu-item"><a class="header-nav-submenu-item__link" href="/labs/myst/"><span class="header-nav-submenu-item__icon"><i class="fas fa-user-secret"></i></span><span class="header-nav-submenu-item__text">秘境</span></a></div></div></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/about/"><span class="header-nav-menu-item__icon"><i class="fas fa-user"></i></span><span class="header-nav-menu-item__text">About</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/links/"><span class="header-nav-menu-item__icon"><i class="fas fa-link"></i></span><span class="header-nav-menu-item__text">友链</span></a></div></div><div class="header-nav-search"><span class="header-nav-search__icon"><i class="fas fa-search"></i></span><span class="header-nav-search__text">Search</span></div><div class="header-nav-mode"><div class="mode"><div class="mode-track"><span class="mode-track-moon"></span><span class="mode-track-sun"></span></div><div class="mode-thumb"></div></div></div></div></nav><div class="header-banner"><div class="header-banner-info"><div class="header-banner-info__title">hihi007's Blog</div><div class="header-banner-info__subtitle">唯一不变的就是一直在变</div></div><div class="header-banner-arrow"><div class="header-banner-arrow__icon"><i class="fas fa-angle-down"></i></div></div></div></div></header><main class="main" id="main"><div class="main-inner"><div class="content-wrap" id="content-wrap"><div class="content" id="content"><div id="is-post"></div><div class="post"><header class="post-header"><h1 class="post-title">区块链：初探ETH私链搭建</h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2020-05-27</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">2020-05-27</span></span><span class="post-meta-item post-meta-item--wordcount"><span class="post-meta-item__icon"><i class="far fa-file-word"></i></span><span class="post-meta-item__info">Words</span><span class="post-meta-item__value">3.3k</span></span><span class="post-meta-item post-meta-item--readtime"><span class="post-meta-item__icon"><i class="far fa-clock"></i></span><span class="post-meta-item__info">Reading</span><span class="post-meta-item__value">23m</span></span><span class="post-meta-item post-meta-item--visitors"><span class="post-meta-item__icon" data-popover="Visitors" data-popover-pos="up"><i class="fas fa-eye"></i></span><span class="post-meta-item__value" id="busuanzi_value_page_pv"></span></span></div></header><div class="post-body"><h3 id="0x00-ETH的前世今生"><a href="#0x00-ETH的前世今生" class="heading-link"><i class="fas fa-link"></i></a>0x00 ETH的前世今生</h3><blockquote><p>比特币开创了去中心化加密货币的先河，自诞生起，五年多的时间充分检验了区块链技术的可行性和安全性。比特币的区块链事实上是一套分布式的数据库，在其中加进一个符号比特币，并规定一套协议使得这个符号可以在数据库上安全地转移，并且无需信任第三方，这些特征的组合完美地构造了一个货币传输体系“比特币网络”。<br>然而比特币并不完美，其中协议的扩展性是一项不足，例如比特币网络里只有一种符号比特币，用户无法自定义另外的符号，这些符号可以是代表公司的股票，或者是债务凭证等，这就损失了一些功能。另外，比特币协议里使用了一套基于堆栈的脚本语言，这语言虽然具有一定灵活性，使得像多重签名这样的功能得以实现，然而却不足以构建更高级的应用，例如去中心化交易所等。以太坊从设计上就是为了解决比特币扩展性不足的问题。<br>以太坊（英文Ethereum）是一个开源的有智能合约功能的公共区块链平台，通过其专用加密货币以太币（Ether，简称“ETH”）提供去中心化的以太虚拟机（Ethereum Virtual Machine）来处理点对点合约。<br>以太坊的概念首次在2013至2014年间由程序员Vitalik Buterin受比特币启发后提出，大意为“下一代加密货币与去中心化应用平台”，在2014年通过ICO众筹开始得以发展。<br>截至2018年2月，以太币是市值第二高的加密货币，仅次于比特币。</p></blockquote><a id="more"></a><h3 id="0x01-初步环境部署"><a href="#0x01-初步环境部署" class="heading-link"><i class="fas fa-link"></i></a>0x01 初步环境部署</h3><blockquote><p><strong>以下所有操作基于CentOS 7 x64 1908 2core 4GB 100G</strong></p></blockquote><figure class="highlight plain"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"># 安装go环境</span><br><span class="line">$ yum -y install golang</span><br><span class="line"></span><br><span class="line"># 下载geth</span><br><span class="line"># https://geth.ethereum.org/downloads/ </span><br><span class="line"># 执行help显示如下内容则安装成功</span><br><span class="line">$ geth -h</span><br><span class="line">NAME:</span><br><span class="line">   geth - the go-ethereum command line interface</span><br><span class="line"></span><br><span class="line">   Copyright 2013-2019 The go-ethereum Authors</span><br><span class="line"></span><br><span class="line">USAGE:</span><br><span class="line">   geth [options] command [command options] [arguments...]</span><br><span class="line">   </span><br><span class="line">VERSION:</span><br><span class="line">   1.9.14-stable-6d74d1e5</span><br></pre></td></tr></tbody></table></div></figure><h3 id="0x02-搭建私有链"><a href="#0x02-搭建私有链" class="heading-link"><i class="fas fa-link"></i></a>0x02 搭建私有链</h3><figure class="highlight plain"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"># 创建存放数据与配置的目录</span><br><span class="line">$ mkdir -p /data/eth/{chaindata,config}</span><br><span class="line"></span><br><span class="line">$ cat /data/eth/config/genesis.json</span><br><span class="line">{</span><br><span class="line">  "config": {</span><br><span class="line">    "chainId": 10,</span><br><span class="line">    "homesteadBlock": 0,</span><br><span class="line">    "eip150Block": 0,</span><br><span class="line">    "eip150Hash": "0x0000000000000000000000000000000000000000000000000000000000000000",</span><br><span class="line">    "eip155Block": 0,</span><br><span class="line">    "eip158Block": 0,</span><br><span class="line">    "byzantiumBlock": 0,</span><br><span class="line">    "constantinopleBlock": 0,</span><br><span class="line">    "petersburgBlock": 0,</span><br><span class="line">    "istanbulBlock": 0,</span><br><span class="line">    "ethash": {}</span><br><span class="line">  },</span><br><span class="line">  "nonce": "0x0000000000000042",</span><br><span class="line">  "timestamp": "0x00",</span><br><span class="line">  "extraData": "0x0000000000000000000000000000000000000000000000000000000000000000",</span><br><span class="line">  "gasLimit": "0xffffffff",</span><br><span class="line">  "difficulty": "0x20000",</span><br><span class="line">  "mixHash": "0x0000000000000000000000000000000000000000000000000000000000000000",</span><br><span class="line">  "coinbase": "0x0000000000000000000000000000000000000000",</span><br><span class="line">  "alloc": {}</span><br><span class="line">  },</span><br><span class="line">  "number": "0x0",</span><br><span class="line">  "gasUsed": "0x0",</span><br><span class="line">  "parentHash": "0x0000000000000000000000000000000000000000000000000000000000000000"</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></div></figure><div class="table-container"><table><thead><tr><th>初始化参数</th><th>作用</th></tr></thead><tbody><tr><td>mixhash</td><td>与nonce配合用于挖矿，由上一个区块的一部分生成的hash。</td></tr><tr><td>nonce</td><td>nonce是一个64位的随机数，用于挖矿用的。他和mixhash的设置需要满足以太坊的官方条件</td></tr><tr><td>difficulty</td><td>设置当前区块的难度，如果难度过大，cpu挖矿就很难，这里设置较小难度</td></tr><tr><td>alloc</td><td>用来预置账号以及账号的以太币数量，因为私有链挖矿比较容易，所以我们不需要预置有币的账号，需要的时候自己创建即可以。</td></tr><tr><td>coinbase</td><td>矿工的账号</td></tr><tr><td>timestamp</td><td>设置创世块的时间戳</td></tr><tr><td>parentHash</td><td>上一个区块的hash值，因为是创世块，所以这个值是0</td></tr><tr><td>extraData</td><td>附加信息，随便填，可以填你的个性信息</td></tr><tr><td>gasLimit</td><td>该值设置对GAS的消耗总量限制，用来限制区块能包含的交易信息总和，因为我们是私有链，所以填最大。</td></tr></tbody></table></div><p><strong>初始化：写入创世区块</strong></p><blockquote><p>准备好创世区块配置文件后，需要初始化区块链，将上面的创世区块信息写入到区块链中。首先要新建一个目录用来存放区块链数据，假设新建的数据目录为/data/eth/chaindata，genesis.json保存在/data/eth/config/中，此时目录结构应该是这样的：</p></blockquote><figure class="highlight plain"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">eth</span><br><span class="line">├── chaindata</span><br><span class="line">└── config</span><br></pre></td></tr></tbody></table></div></figure><div class="table-container"><table><thead><tr><th>初始化命令</th><th>作用</th></tr></thead><tbody><tr><td>Identity</td><td>区块链的标示，随便填写，用于标示目前网络的名字</td></tr><tr><td>Init</td><td>指定创世块文件的位置，并创建初始块</td></tr><tr><td>datadir</td><td>设置当前区块链网络数据存放的位置</td></tr><tr><td>rpc</td><td>启动rpc通信，可以进行智能合约的部署和调试</td></tr><tr><td>rpcport</td><td>HTTP-RPC服务器监听端口(default: 8545)</td></tr><tr><td>rpcapi</td><td>设置允许连接的rpc的客户端，默认只有eth,net,web3</td></tr><tr><td>networkid</td><td>设置当前区块链的网络ID，用于区分不同的网络，是一个数字</td></tr><tr><td>console</td><td>启动命令行模式，可以在Geth中执行命令</td></tr><tr><td>rpccorsdomain</td><td>指定一个可以接收请求来源的以逗号间隔的域名列表（浏览器访问的话，要强制指定该选项）</td></tr></tbody></table></div><figure class="highlight plain"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"># 执行初始化命令：</span><br><span class="line">$ geth --datadir /data/eth/chaindata init /data/eth/config/genesis.json</span><br><span class="line"># 输出Successfully wrote genesis state则代表初始化成功。</span><br><span class="line"># 初始化成功后数据目录生成geth和keystore两个文件夹，其中 geth/chaindata中存放的是区块数据，keystore中存放的是账户数据。</span><br><span class="line"></span><br><span class="line"># 启动私有链节点并进入控制台</span><br><span class="line">$ geth --datadir /data/eth/chaindata/ --networkid 666 console</span><br><span class="line">Welcome to the Geth JavaScript console!</span><br><span class="line"></span><br><span class="line">instance: Geth/v1.9.14-stable-6d74d1e5/linux-amd64/go1.14.2</span><br><span class="line">at block: 0 (Thu Jan 01 1970 08:00:00 GMT+0800 (CST))</span><br><span class="line"> datadir: /data/eth/chaindata</span><br><span class="line"> modules: admin:1.0 debug:1.0 eth:1.0 ethash:1.0 miner:1.0 net:1.0 personal:1.0 rpc:1.0 txpool:1.0 web3:1.0</span><br><span class="line"></span><br><span class="line"># 这是一个交互式的Javascript执行环境，在这里面可以执行Javascript代码，其中&gt;是命令提示符。在这个环境里也内置了一些用来操作以太坊的Javascript对象，可以直接使用这些对象。这些对象主要包括：</span><br><span class="line"></span><br><span class="line">eth：包含一些跟操作区块链相关的方法</span><br><span class="line">net：包含以下查看p2p网络状态的方法</span><br><span class="line">admin：包含一些与管理节点相关的方法</span><br><span class="line">miner：包含启动&amp;停止挖矿的一些方法</span><br><span class="line">personal：主要包含一些管理账户的方法</span><br><span class="line">txpool：包含一些查看交易内存池的方法</span><br><span class="line">web3：包含了以上对象，还包含一些单位换算的方法</span><br><span class="line"></span><br><span class="line"># 其中常用命令有：</span><br><span class="line"></span><br><span class="line">personal.newAccount()：创建账户；</span><br><span class="line">personal.unlockAccount()：解锁账户；</span><br><span class="line">eth.accounts：枚举系统中的账户；</span><br><span class="line">eth.getBalance()：查看账户余额，返回值的单位是 Wei（Wei - 是以太坊中最小货币面额单位，类似比特币中的聪，1 ether = 10^18 Wei）；</span><br><span class="line">eth.blockNumber：列出区块总数；</span><br><span class="line">eth.getTransaction()：获取交易；</span><br><span class="line">eth.getBlock()：获取区块；</span><br><span class="line">miner.start()：开始挖矿；</span><br><span class="line">miner.stop()：停止挖矿；</span><br><span class="line">web3.fromWei()：Wei 换算成以太币；</span><br><span class="line">web3.toWei()：以太币换算成 Wei；</span><br><span class="line">txpool.status：交易池中的状态；</span><br><span class="line">admin.addPeer()：连接到其他节点；</span><br></pre></td></tr></tbody></table></div></figure><h3 id="0x03-探索JavaScript-Console"><a href="#0x03-探索JavaScript-Console" class="heading-link"><i class="fas fa-link"></i></a>0x03 探索JavaScript Console</h3><p><strong>进入以太坊Javascript Console后，就可以使用里面的内置对象做一些操作，这些内置对象提供的功能很丰富，比如查看区块和交易、创建账户、挖矿、发送交易、部署智能合约等。 接下来介绍几个常用功能，下面的操作中，前面带&gt;的表示在Javascript Console中执行的命令。</strong></p><figure class="highlight plain"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"># 前面只是搭建了私有链，并没有自己的账户，可以在js console中输入eth.accounts来验证：</span><br><span class="line">&gt; eth.accounts</span><br><span class="line">[]</span><br><span class="line"></span><br><span class="line"># 创建用户</span><br><span class="line"># 接下来使用personal对象来创建一个账户</span><br><span class="line"># 注意：此命令区分大小写。</span><br><span class="line">&gt; personal.newAccount()</span><br><span class="line">Passphrase: </span><br><span class="line">Repeat passphrase: </span><br><span class="line">INFO [05-27|15:57:01.715] Your new key was generated               address=0x3bd8f1aDf6fCe874B6FC004629cCdb30f16E5283</span><br><span class="line">WARN [05-27|15:57:01.715] Please backup your key file!             path=/data/eth/chaindata/keystore/UTC--2020-05-27T07-56-59.917964036Z--3bd8f1adf6fce874b6fc004629ccdb30f16e5283</span><br><span class="line">WARN [05-27|15:57:01.715] Please remember your password! </span><br><span class="line">"0x3bd8f1adf6fce874b6fc004629ccdb30f16e5283"</span><br><span class="line"></span><br><span class="line"># 会提示输入密码和确认密码，输入密码不会有显示，只要输入就可以了，之后就会显示新创建的账户地址。可以创建多个账户。</span><br><span class="line"># 账户默认会保存在数据目录的keystore文件夹中。查看目录结构，发现keystore中多了个文件，这个文件就对应刚才创建的账户，这是json格式的文本文件，可以打开查看，里面存的是私钥经过密码加密后的信息。</span><br><span class="line">├── chaindata</span><br><span class="line">└── keystore</span><br><span class="line">└── UTC--2020-05-27T07-56-59.917964036Z--3bd8f1adf6fce874b6fc004629ccdb30f16e5283</span><br><span class="line"></span><br><span class="line"># 查看账户</span><br><span class="line">&gt; admin.nodeInfo.enode</span><br><span class="line">"enode://4e9dc8b2c36bd39fc183063a90cd3bbdd52b2aba48ab6225a54a43b56ef0f230ef5be787807e19df83cd35946187335c9e8d0a20d4ec91535266271a30826c42@113.110.225.141:30303?discport=2072"</span><br><span class="line"></span><br><span class="line"># 查看账户余额</span><br><span class="line">&gt; eth.getBalance("0x3bd8f1adf6fce874b6fc004629ccdb30f16e5283")</span><br><span class="line">0</span><br><span class="line"># 目前账户的以太币余额是0，要使账户有余额，可以从其他账户转账过来，或者通过挖矿来获得以太币奖励。</span><br></pre></td></tr></tbody></table></div></figure><p>0x04 致富之道~挖矿</p><blockquote><p>通过miner.start()来启动挖矿<br>通过miner.stop()来停止挖矿<br>其中start的参数表示挖矿使用的线程数。第一次启动挖矿会先生成挖矿所需的DAG文件，这个过程有点慢，等进度达到100%后，就会开始挖矿，此时屏幕会被挖矿信息刷屏。</p></blockquote><figure class="highlight plain"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&gt; miner.start(2)</span><br><span class="line">INFO [05-27|16:11:45.236] Generating DAG in progress               epoch=0 percentage=0 elapsed=1.140s</span><br><span class="line">INFO [05-27|16:11:46.440] Generating DAG in progress               epoch=0 percentage=1 elapsed=2.345s</span><br><span class="line">INFO [05-27|16:11:47.686] Generating DAG in progress               epoch=0 percentage=2 elapsed=3.591s</span><br><span class="line">INFO [05-27|16:11:48.842] Generating DAG in progress               epoch=0 percentage=3 elapsed=4.747s</span><br><span class="line">INFO [05-27|16:11:49.969] Generating DAG in progress               epoch=0 percentage=4 elapsed=5.873s</span><br><span class="line">INFO [05-27|16:11:51.178] Generating DAG in progress               epoch=0 percentage=5 elapsed=7.082s</span><br><span class="line">INFO [05-27|16:11:52.375] Generating DAG in progress               epoch=0 percentage=6 elapsed=8.280s</span><br><span class="line">INFO [05-27|16:11:53.534] Generating DAG in progress               epoch=0 percentage=7 elapsed=9.439s</span><br><span class="line">INFO [05-27|16:11:54.778] Generating DAG in progress               epoch=0 percentage=8 elapsed=10.682s</span><br><span class="line">INFO [05-27|16:11:55.954] Generating DAG in progress               epoch=0 percentage=9 elapsed=11.859s</span><br><span class="line">INFO [05-27|16:11:57.155] Generating DAG in progress               epoch=0 percentage=10 elapsed=13.060s</span><br><span class="line">INFO [05-27|16:11:58.420] Generating DAG in progress               epoch=0 percentage=11 elapsed=14.324s</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 矿工账户： 挖到一个区块会奖励5个以太币，挖矿所得的奖励会进入矿工的账户，这个账户叫做coinbase，默认情况下coinbase是本地账户中的第一个账户，通过miner.setEtherbase()可将其他账户设置成coinbase。</span><br><span class="line"></span><br><span class="line"># 查看余额</span><br><span class="line">&gt; eth.getBalance(eth.accounts[0])</span><br><span class="line">570000000000000000000</span><br><span class="line"></span><br><span class="line"># 别看这里那么多个0 其实只有570个以太币。</span><br><span class="line"># getBalance()返回值的单位是wei，wei是以太币的最小单位，1个以太币=10的18次方个wei。要查看有多少个以太币，可以用web3.fromWei()将返回值换算成以太币：</span><br><span class="line">&gt; web3.fromWei(eth.getBalance(eth.accounts[0]),'ether')</span><br><span class="line">570</span><br></pre></td></tr></tbody></table></div></figure><h3 id="0x05-交易"><a href="#0x05-交易" class="heading-link"><i class="fas fa-link"></i></a>0x05 交易</h3><figure class="highlight plain"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"># 先查看一下我们两个账户的余额。 账户0 有570个以太币 账户 1 为零个。</span><br><span class="line">&gt; web3.fromWei(eth.getBalance(eth.accounts[0]),'ether')</span><br><span class="line">570</span><br><span class="line">&gt; web3.fromWei(eth.getBalance(eth.accounts[1]),'ether')</span><br><span class="line">0</span><br><span class="line"></span><br><span class="line"># 可以通过发送一笔交易，从A账户转移N个以太币到B账户;</span><br><span class="line"># 注意：在交易过程中，无论交易的代币是什么，都需要把这些代币转为 wei 存储在以太坊区块链中</span><br><span class="line">&gt; amount = web3.toWei(5,'ether')</span><br><span class="line">"5000000000000000000"</span><br><span class="line"></span><br><span class="line"># 这里 amount = web3.toWei(5,’ether’) 是把5个以太币转换为wei 赋值给amount。</span><br><span class="line"># 发送交易</span><br><span class="line">&gt; eth.sendTransaction({from:eth.accounts[0],to:eth.accounts[1],value:amount})</span><br><span class="line">WARN [05-27|16:29:39.024] Served eth_sendTransaction               reqid=50 t=2.022748ms err="authentication needed: password or unlock"</span><br><span class="line">Error: authentication needed: password or unlock</span><br><span class="line">	at web3.js:6347:37(47)</span><br><span class="line">	at web3.js:5081:62(37)</span><br><span class="line">	at &lt;eval&gt;:1:20(16)</span><br><span class="line"></span><br><span class="line"># 执行报错  是因为账户每过一段时间就会被锁住，想要发送交易，必须先解锁账户，由于我们要从账户0发送交易，所以要解锁账户0：</span><br><span class="line">&gt; personal.unlockAccount(eth.accounts[0])</span><br><span class="line">true</span><br><span class="line"></span><br><span class="line"># 函数的第一个参数 是发送者地址，第二个接收者的地址，第三个是转账的金额，以wei为单位。然后执行转账操作。</span><br><span class="line">&gt; eth.sendTransaction({from:eth.accounts[0],to:eth.accounts[1],value:amount})</span><br><span class="line">INFO [05-27|16:37:32.294] Setting new local account                address=0x3bd8f1aDf6fCe874B6FC004629cCdb30f16E5283</span><br><span class="line">INFO [05-27|16:37:32.294] Submitted transaction                    fullhash=0xcd8d8788703b52aedb10642a93490144b858fb1a851a80780005c5f26af54a69 recipient=0x5407117Bbb2bfA61C8ccAeFB209d10ffB82224cF</span><br><span class="line">"0xcd8d8788703b52aedb10642a93490144b858fb1a851a80780005c5f26af54a69"</span><br><span class="line"></span><br><span class="line"># 回显这个说明交易已经提交到区块链里了，返回的hash值是交易hash，但是交易并未  被处理。 可以通过txpool.status来查看状态。</span><br><span class="line">&gt; txpool.status</span><br><span class="line">{</span><br><span class="line">  pending: 1,</span><br><span class="line">  queued: 0</span><br><span class="line">}</span><br><span class="line"># 其中有一条pending的交易，pending表示已提交但还未被处理的交易。</span><br><span class="line"></span><br><span class="line"># 要使交易被处理，必须要挖矿。这里我们启动挖矿，然后等待挖到一个区块之后就停止挖矿：</span><br><span class="line">&gt; miner.start(1);admin.sleepBlocks(1);miner.stop();</span><br><span class="line"></span><br><span class="line"># 当miner.stop()返回true后，txpool中pending的交易数量应该为0了，说明交易已经被处理了：</span><br><span class="line">&gt;  txpool.status</span><br><span class="line">{</span><br><span class="line">  pending: 0,</span><br><span class="line">  queued: 0</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"># 此时，交易已经生效，账户一应该已经收到了5个以太币了：</span><br><span class="line">&gt; web3.fromWei(eth.getBalance(eth.accounts[1]),'ether')</span><br><span class="line">5</span><br></pre></td></tr></tbody></table></div></figure><h3 id="0x06-查看交易和区块"><a href="#0x06-查看交易和区块" class="heading-link"><i class="fas fa-link"></i></a>0x06 查看交易和区块</h3><figure class="highlight plain"><div class="table-container"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"># eth对象封装了查看交易和区块信息的方法。</span><br><span class="line"># 查看当前区块总数：</span><br><span class="line">&gt; eth.blockNumber</span><br><span class="line">304</span><br><span class="line"></span><br><span class="line"># 通过区块号(高度)查看区块信息，通过交易hash查看交易：</span><br><span class="line">&gt; eth.getBlock(304)</span><br><span class="line">{</span><br><span class="line">  difficulty: 144223,</span><br><span class="line">  extraData: "0xd88301090e846765746888676f312e31342e32856c696e7578",</span><br><span class="line">  gasLimit: 3191286136,</span><br><span class="line">  gasUsed: 0,</span><br><span class="line">  hash: "0xe544e23bc3e46ad075da379cc752d649e445fe1e4ddbce906d32b7ebab6bcf11",</span><br><span class="line">  logsBloom: "0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",</span><br><span class="line">  miner: "0x3bd8f1adf6fce874b6fc004629ccdb30f16e5283",</span><br><span class="line">  mixHash: "0x30d20e4aac3266f4f561bb23b2eca5a1f54733ba1113ea40b4ea0ae9a22a4fb3",</span><br><span class="line">  nonce: "0x615b10f022b804a6",</span><br><span class="line">  number: 304,</span><br><span class="line">  parentHash: "0xed01bbb45f9f42b4a6f0623f358995b6353a7c6a443b8c6ec5ad1c3c09f15f1b",</span><br><span class="line">  receiptsRoot: "0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421",</span><br><span class="line">  sha3Uncles: "0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347",</span><br><span class="line">  size: 539,</span><br><span class="line">  stateRoot: "0x10b647884f1252a94d8031e8323e8f3a15db904c7439d252099b4ccd7443d6ca",</span><br><span class="line">  timestamp: 1590569121,</span><br><span class="line">  totalDifficulty: 42861137,</span><br><span class="line">  transactions: [],</span><br><span class="line">  transactionsRoot: "0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421",</span><br><span class="line">  uncles: []</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"># 也可以通过交易hash 查看交易记录</span><br><span class="line"></span><br><span class="line">&gt; eth.getTransaction("0xcd8d8788703b52aedb10642a93490144b858fb1a851a80780005c5f26af54a69")</span><br><span class="line">{</span><br><span class="line">  blockHash: "0x2fc36d2f47f521762eafaf349507be8f6db2c6fc05ff0d726e4ff810d40b71e2",</span><br><span class="line">  blockNumber: 286,</span><br><span class="line">  from: "0x3bd8f1adf6fce874b6fc004629ccdb30f16e5283",</span><br><span class="line">  gas: 21000,</span><br><span class="line">  gasPrice: 1000000000,</span><br><span class="line">  hash: "0xcd8d8788703b52aedb10642a93490144b858fb1a851a80780005c5f26af54a69",</span><br><span class="line">  input: "0x",</span><br><span class="line">  nonce: 0,</span><br><span class="line">  r: "0x92aecdc0b6236e0eb50f5209e9d71ce4114803755c2ffd7213aef023efd18dc0",</span><br><span class="line">  s: "0x23f32849c259e367de89318904d11e33c99bf124e9bf6b8ec369625f06455011",</span><br><span class="line">  to: "0x5407117bbb2bfa61c8ccaefb209d10ffb82224cf",</span><br><span class="line">  transactionIndex: 0,</span><br><span class="line">  v: "0x37",</span><br><span class="line">  value: 5000000000000000000</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></div></figure><p><strong>还有更多的功能请自行了解与探索。</strong></p><script>document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });</script></div><footer class="post-footer"><div class="post-ending ending"><div class="ending__text">------ END ------</div></div><div class="post-tags"><span class="post-tags-item"><span class="post-tags-item__icon"><i class="fas fa-tag"></i></span><a class="post-tags-item__link" href="https://www.gov-cn.cn/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/">区块链</a></span><span class="post-tags-item"><span class="post-tags-item__icon"><i class="fas fa-tag"></i></span><a class="post-tags-item__link" href="https://www.gov-cn.cn/tags/ETH/">ETH</a></span></div><div class="post-reward reward"><div class="reward-button">Buy me a coffee</div><div class="reward-qrcode"><span class="reward-qrcode-alipay"><img class="reward-qrcode-alipay__img" src="https://static-hk.gov-cn.cn/cdn/images/alipay.jpg"><div class="reward-qrcode-alipay__text">Alipay</div></span><span class="reward-qrcode-wechat"><img class="reward-qrcode-wechat__img" src="https://static-hk.gov-cn.cn/cdn/images/wechatpay.jpg"><div class="reward-qrcode-wechat__text">Wechat</div></span></div></div><nav class="post-paginator paginator"><div class="paginator-prev"><a class="paginator-prev__link" href="/posts/5ebf5ee8/"><span class="paginator-prev__icon"><i class="fas fa-angle-left"></i></span><span class="paginator-prev__text">CVE-2020-0796漏洞利用与修复</span></a></div><div class="paginator-next"><a class="paginator-next__link" href="/posts/a21a6de5/"><span class="paginator-prev__text">MYSQL备份脚本(支持备份多个数据库)</span><span class="paginator-next__icon"><i class="fas fa-angle-right"></i></span></a></div></nav></footer></div></div><div class="comments" id="comments"><div id="valine-container"></div></div></div><div class="sidebar-wrap" id="sidebar-wrap"><aside class="sidebar" id="sidebar"><div class="sidebar-nav"><span class="sidebar-nav-toc current">Catalog</span><span class="sidebar-nav-ov">Overview</span></div><section class="sidebar-toc"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#0x00-ETH的前世今生"><span class="toc-number">1.</span> <span class="toc-text">0x00 ETH的前世今生</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x01-初步环境部署"><span class="toc-number">2.</span> <span class="toc-text">0x01 初步环境部署</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x02-搭建私有链"><span class="toc-number">3.</span> <span class="toc-text">0x02 搭建私有链</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x03-探索JavaScript-Console"><span class="toc-number">4.</span> <span class="toc-text">0x03 探索JavaScript Console</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x05-交易"><span class="toc-number">5.</span> <span class="toc-text">0x05 交易</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x06-查看交易和区块"><span class="toc-number">6.</span> <span class="toc-text">0x06 查看交易和区块</span></a></li></ol></section><section class="sidebar-ov hide"><div class="sidebar-ov-author"><div class="sidebar-ov-author__avatar"><img class="sidebar-ov-author__avatar_img" src="/images/icons/avatar.svg" alt="avatar"></div><p class="sidebar-ov-author__text">唯一不变的就是一直在变</p></div><div class="sidebar-ov-social"><a class="sidebar-ov-social-item" href="https://github.com/beytagh-stark" target="_blank" rel="noopener" data-popover="Github" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fab fa-github"></i></span></a><a class="sidebar-ov-social-item" href="https://static-hk.gov-cn.cn/cdn/images/wechatqr.png" target="_blank" rel="noopener" data-popover="Wechat" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fab fa-weixin"></i></span></a><a class="sidebar-ov-social-item" href="https://t.me/hihi007s" target="_blank" rel="noopener" data-popover="Telegram" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fab fa-telegram"></i></span></a><a class="sidebar-ov-social-item" href="http://wpa.qq.com/msgrd?v=3&amp;uin=1727488558&amp;site=qq&amp;menu=yes" target="_blank" rel="noopener" data-popover="QQ" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fab fa-qq"></i></span></a></div></section><div class="sidebar-reading"><div class="sidebar-reading-info"><span class="sidebar-reading-info__text">You have read </span><span class="sidebar-reading-info__num">0</span></div><div class="sidebar-reading-line"></div></div></aside></div><div class="clearfix"></div></div></main><footer class="footer" id="footer"><div class="footer-inner"><div><span>Copyright © 2016~2020</span><span class="footer__icon"><i class="fas fa-heart"></i></span><span>gov-cn.cn</span><span class="footer__devider">|</span><span>粤ICP备-19148026号</span></div><div class="busuanzi"><span class="busuanzi-siteuv"><span class="busuanzi-siteuv__icon" data-popover-pos="up" data-popover="Unique Visitor"><i class="fas fa-user"></i></span><span class="busuanzi-siteuv__value" id="busuanzi_value_site_uv"></span></span><span class="busuanzi-sitepv"><span class="busuanzi-siteuv__icon" data-popover-pos="up" data-popover="Page View"><i class="fas fa-eye"></i></span><span class="busuanzi-siteuv__value" id="busuanzi_value_site_pv"></span></span></div><div>技术支持：Service:Github Pages / Admin:Hexo / Theme:Stun</div></div></footer><div class="loading-bar" id="loading-bar"><div class="loading-bar__progress"></div></div><div class="back2top" id="back2top"><span class="back2top__icon"><i class="fas fa-rocket"></i></span></div></div><div class="search-mask"></div><div class="search-popup"><span class="search-close"></span><div class="search-input"><input placeholder="Search for Posts (Support multiple keywords)"></div><div class="search-results"></div></div><script src="https://cdn.jsdelivr.net/npm/jquery@v3.4.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.ui.min.js"></script><script src="https://cdn.jsdelivr.net/npm/ribbon.js@latest/dist/ribbon.min.js" size="120" alpha="0.6" zindex="-1"></script><script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script><script>function initSearch(){var i=!0,e="search.json";e?/json$/i.test(e)&&(i=!1):e="search.xml";var t="/"+e;$.ajax({url:t,dataType:i?"xml":"json",async:!0,success:function(e){var n=i?$("entry",e).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get():e,o=$(".search-input input"),c=$(".search-results"),y=100,m=1,t=function(){var e=o.val().toLowerCase().trim(),x=e.split(/[\s]+/),w=[];1<x.length&&x.push(e),0<e.length&&n.forEach(function(e){var t=!1,n=e.title&&e.title.trim()||"[ Untitled ]",o=n&&n.toLowerCase(),c=e.content&&e.content.replace(/<[^>]+>/g,""),i=c&&c.toLowerCase(),r=e.url&&decodeURI(e.url).replace(/\/{2,}/g,"/"),s=[],a=[];x.forEach(function(e){function t(t,e,n,o){if(!t||!e)return[];var c=0,i=-1,r=[];for(n||(t=t.toLowerCase(),e=e.toLowerCase());-1!==(i=e.indexOf(t,c));){var a=!1;s.forEach(function(e){e.index===i&&e.word.length<t.length&&(e.word=t,a=!0)}),c=i+t.length,!a&&r.push({index:i,word:t,weight:o})}return r}s=s.concat(t(e,o,!1,y)),a=a.concat(t(e,i,!1,m))});var l=s.length,u=a.length;if((0<l||0<u)&&(t=!0),t){function h(n,e,t,o){if(n&&e&&e.length){var c="",i=t,r=o;return e.forEach(function(e){if(!(e.index<i)){var t=e.index+e.word.length;c+=n.slice(i,e.index),c+="<b>"+n.slice(e.index,t)+"</b>",i=t}}),c+=n.slice(i,r)}}[s,a].forEach(function(e){e.sort(function(e,t){return e.index-t.index})});var d,f={},p=s.length*y+a.length*m,v=h(n,s,0,n.length)||n;if(0<a.length){var g=a[0].index;d=h(c,a,20<g?g-20:0,g+180)}else d=c.slice(0,200);f.title=v,f.content=d,f.url=r,f.weight=p,w.push(f)}});var t="";w.length?(w.sort(function(e,t){return t.weight-e.weight}),t+="<ul>",w.forEach(function(e){t+='<li><a class="search-results-title" href="'+e.url+'">',t+=e.title,t+='</a><div class="search-results-content">',t+=e.content,t+="</div></li>"}),t+="</ul>"):t+='<div class="search-results-none"><i class="far fa-meh"></i></div>',c.html(t)};o.on("input",t),o.on("keyup",function(e){e.keyCode===Stun.utils.codeToKeyCode("Enter")&&t()})}})}function closeSearch(){$("body").css({overflow:"auto"}),$(".search-popup").css({display:"none"}),$(".search-mask").css({display:"none"})}window.addEventListener("DOMContentLoaded",function(){Stun.utils.pjaxReloadLocalSearch=function(){$(".header-nav-search").on("click",function(e){e.stopPropagation(),$("body").css("overflow","hidden"),$(".search-popup").velocity("stop").velocity("transition.expandIn",{duration:300,complete:function(){$(".search-popup input").focus()}}),$(".search-mask").velocity("stop").velocity("transition.fadeIn",{duration:300}),initSearch()}),$(".search-mask, .search-close").on("click",function(){closeSearch()}),$(document).on("keydown",function(e){e.keyCode===Stun.utils.codeToKeyCode("Escape")&&closeSearch()})},Stun.utils.pjaxReloadLocalSearch()},!1)</script><script src="https://cdn.jsdelivr.net/npm/pjax@latest/pjax.min.js"></script><script>window.addEventListener("DOMContentLoaded",function(){new Pjax({selectors:["head title","#main",".pjax-reload"],history:!0,scrollTo:!1,scrollRestoration:!1,cacheBust:!1,debug:!1,currentUrlFullReload:!1,timeout:0});var e=null;document.addEventListener("pjax:send",function(){$(".header-nav-menu").removeClass("show"),CONFIG.pjax&&CONFIG.pjax.avoidBanner&&$("html").velocity("scroll",{duration:500,offset:$("#header").height(),easing:"easeInOutCubic"});var a=20;$(".loading-bar").addClass("loading"),$(".loading-bar__progress").css("width",a+"%"),clearInterval(e),e=setInterval(function(){95<(a+=3)&&(a=95),$(".loading-bar__progress").css("width",a+"%")},500)},!1),window.addEventListener("pjax:complete",function(){clearInterval(e),$(".loading-bar__progress").css("width","100%"),$(".loading-bar").removeClass("loading"),setTimeout(function(){$(".loading-bar__progress").css("width","0")},400),$("link[rel=prefetch], script[data-pjax-rm]").each(function(){$(this).remove()}),$("script[data-pjax], #pjax-reload script").each(function(){$(this).parent().append($(this).remove())}),Stun.utils.pjaxReloadBoot&&Stun.utils.pjaxReloadBoot(),Stun.utils.pjaxReloadScroll&&Stun.utils.pjaxReloadScroll(),Stun.utils.pjaxReloadSidebar&&Stun.utils.pjaxReloadSidebar()},!1)},!1)</script><div id="pjax-reload"><script src="https://cdn.jsdelivr.net/gh/sukkaw/busuanzi@latest/bsz.pure.mini.js" async></script></div><script src="https://cdn.jsdelivr.net/npm/leancloud-storage@latest/dist/av-min.js"></script><script src="https://cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js"></script><script data-pjax="">function loadValine(){var n=["nick","mail","link"],a="nick,mail,link";a=a.split(",").filter(function(a){return-1<n.indexOf(a)}),new Valine({el:"#valine-container",appId:"jopXGpKoDU5p4BsP7nFerKcN-MdYXbMMI",appKey:"Y9MzjOW5wP0rMrhvS4C2Wvay",notify:!1,verify:!0,placeholder:"不留点念想吗？",avatar:"mp",meta:a,pageSize:"10",visitor:!1,recordIP:!1,lang:"zh-cn",path:window.location.pathname})}loadValine()</script><script src="/js/utils.js?v=2.0.0-rc.0"></script><script src="/js/stun-boot.js?v=2.0.0-rc.0"></script><script src="/js/scroll.js?v=2.0.0-rc.0"></script><script src="/js/header.js?v=2.0.0-rc.0"></script><script src="/js/sidebar.js?v=2.0.0-rc.0"></script></body></html>